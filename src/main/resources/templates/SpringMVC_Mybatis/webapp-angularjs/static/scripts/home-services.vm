(function () {
    angular.module("${moduleName}.service", [])
        .factory('AjaxService', ['$http', function ($http) {
            var service = {};
            var url = "/ajax.do";
            service.example = function (data) {
                return $http({
                    method: 'POST',
                    url: url,
                    data: data,
                    params: {"method": "ajax.${moduleName}.example"}
                });
            };
#foreach($table in $db.tables)
            service.create${table.getCName()} = function (data) {
                return $http({
                    method: 'POST',
                    url: url,
                    data: data,
                    params: {"method": "ajax.${moduleName}.${table.getLName()}.create"}
                });
            };
            service.delete${table.getCName()} = function (data) {
                return $http({
                    method: 'POST',
                    url: url,
                    data: data,
                    params: {"method": "ajax.${moduleName}.${table.getLName()}.delete"}
                });
            };
            service.update${table.getCName()} = function (data) {
                return $http({
                    method: 'POST',
                    url: url,
                    data: data,
                    params: {"method": "ajax.${moduleName}.${table.getLName()}.update"}
                });
            };
            service.find${table.getCName()} = function (data) {
                return $http({
                    method: 'POST',
                    url: url,
                    data: data,
                    params: {"method": "ajax.${moduleName}.${table.getLName()}.find"}
                });
            };
            service.get${table.getCName()} = function (data) {
                return $http({
                    method: 'POST',
                    url: url,
                    data: data,
                    params: {"method": "ajax.${moduleName}.${table.getLName()}.get"}
                });
            };
            service.getAll${table.getCName()} = function (data) {
                return $http({
                    method: 'POST',
                    url: url,
                    data: data,
                    params: {"method": "ajax.${moduleName}.${table.getLName()}.get.all"}
                });
            };
#end
            /**
             * 上传文件
             */
            service.upload = function (file) {
                var fileName = file.name;
                var ext = fileName.substr(fileName.lastIndexOf(".") + 1, fileName.length);
                var url = "/upload.do";
                var fd = new FormData();
                fd.append("file", file);
                return ($http({
                    method: 'POST',
                    url: url,
                    headers: {'Content-Type': undefined},
                    transformRequest: angular.identity,
                    data: fd
                }));
            };
            return service;
        }])
})()
